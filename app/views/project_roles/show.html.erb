<h1>Group: <%= @project_role.name %></h1>
<p><%= @project_role.description %></p>

<h2>Permissions:</h2>
<div id='project-role-permissions'>
</div>

<br>

  <div class="card">
    <h2>Users:</h2>
    <div class="card-content">
      <div class="row">
      <div class="col s4">
        <%= render 'project_role_users/search_form' %>
      </div>
      <div class="col s8">
        <div id='project-role-users'></div>
      </div>
      </div>
    </div>
    </div>

<div>
  <%= render 'project_role_users/match_form' %>
</div>

<h2>Users:</h2>
<%= render 'project_role_users/search_form' %>
<div id='project-role-users'>
</div>
<div>
  <%= render 'project_role_users/match_form' %>
</div>

<h2>Locations:</h2>
<div id='locations'>
</div>
<div id='locations-edit'>
  <%= link_to 'Edit Locations...', project_role_locations_edit_path(code: @project.code, name: @project_role.name), remote: true %>
  <%= text_field_tag 'location_search', nil,  placeholder: 'Location...' %>
</div>

<h2>Skills:</h2>
<div id='skills-edit'>
  <%= link_to project_role_skills_edit_path(code: @project.code, name: @project_role.name), remote: true do %>
    <%= octicon 'pencil' %>
  <% end %>
</div>
<div id='skills'>
</div>

<script>
  loadProjectRoleLocations('<%= @project.code %>','<%= @project_role.name %>');
  loadProjectRoleUsers('<%= @project.code %>','<%= @project_role.name %>');
  loadProjectRolePermissions('<%= @project.code %>','<%= @project_role.name %>');
  loadProjectRoleSkills('<%= @project.code %>','<%= @project_role.name %>');
  $(document).on('turbolinks:load', function() {
    $('#location_search').autocomplete({
      data: <%= @source.html_safe %>,
      onAutocomplete: function(val) {
        $.ajax({
          type: "POST",
          url: "<%= project_role_locations_path(code: @project.code, name: @project_role.name) %>",
          data: { location_name: val },
         cache: false
       })
      }
    })
  })
</script>
